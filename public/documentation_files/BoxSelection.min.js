/*!
 * LMV v7.70.0
 *
 * Copyright 2022 Autodesk, Inc.
 * All rights reserved.
 *
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 *
 * Autodesk Forge Viewer Usage Limitations:
 *
 * The Autodesk Forge Viewer JavaScript must be delivered from an
 * Autodesk-hosted URL.
 */(()=>{var e={54707:(e,t,o)=>{"use strict";o.r(t),o.d(t,{BoxSelectionExtension:()=>ne});const n=THREE.Vector4;function i(e,t){switch(t){case 0:return e.x;case 1:return e.y;case 2:return e.z}return 0}function s(e,t,o,s,r,a){return function(e,t,o,s,r){var a,l,c,h,u;t.length=0,l=e.length&&e[e.length-1],h=s*i(l,o)-l.w*r;for(var d=0;d<e.length;d++,l=a,h=u){if(h<=0^(u=s*i(a=e[d],o)-a.w*r)<=0){c=h/(h-u);var x=new n;x.x=l.x+c*(a.x-l.x),x.y=l.y+c*(a.y-l.y),x.z=l.z+c*(a.z-l.z),x.w=l.w+c*(a.w-l.w),t.push(x)}u<=0&&t.push(a.clone())}}(s[0],r[0],e,t,t*o),0===r[0].length?0:(l=s,c=r,(h=a)[0]=l[0],l[0]=c[0],c[0]=h[0],1);var l,c,h}function r(e,t){for(var o=0,n=0,i=0,r=0,a=0,l=0,c=e.length,h=0;h<c;h++){var u=e[h];u.x<t.min.x*u.w&&o++,u.x>t.max.x*u.w&&n++,u.y<t.min.y*u.w&&i++,u.y>t.max.y*u.w&&r++,u.z<t.min.z*u.w&&a++,u.z>t.max.z*u.w&&l++}if(o+n+i+r+a+l===0)return 2;if(o===c||n===c||i===c||r===c||a===c||l===c)return e.length=0,0;var d=[],x=[e],p=[d],m=[null];return o&&0===s(0,-1,t.min.x,x,p,m)||n&&0===s(0,1,t.max.x,x,p,m)||i&&0===s(1,-1,t.min.y,x,p,m)||r&&0===s(1,1,t.max.y,x,p,m)||a&&0===s(2,-1,t.min.z,x,p,m)||l&&0===s(2,1,t.max.z,x,p,m)?(e.length=0,0):(x[0]===d&&(e.length=0,e.push(...d)),1)}const a=(e,t)=>e.applyProjection(t),{enumMeshLines:l,enumMeshTriangles:c}=Autodesk.Viewing.Private.VertexEnumerator,h=THREE.Frustum,u=THREE.Vector3,d=THREE.Vector4,x=THREE.Box3,p=THREE.Matrix4;var m=new h,v=new p,S=new p,y=new THREE.Box3;y.min.x=-1,y.min.y=-1,y.min.z=-1,y.max.x=1,y.max.y=1,y.max.z=1;var f=new x,g=new u,w=new u,b=new u,T=new u,C=new u,A=new u,B=new u,E=new u,P=new u,N=new u,O=new d,M=new d,z=new d;function I(e,t){for(var o=P,n=N,i=e.planes,s=0,r=0;r<6;r++){var a=i[r];o.x=a.normal.x>0?t.min.x:t.max.x,n.x=a.normal.x>0?t.max.x:t.min.x,o.y=a.normal.y>0?t.min.y:t.max.y,n.y=a.normal.y>0?t.max.y:t.min.y,o.z=a.normal.z>0?t.min.z:t.max.z,n.z=a.normal.z>0?t.max.z:t.min.z;var l=a.distanceToPoint(o),c=a.distanceToPoint(n);if(l<0&&c<0)return 0;l>0&&c>0&&s++}return 6===s?2:1}function k(e,t,o){let n=e.x,i=e.y,s=e.z,r=t.elements;o.x=r[0]*n+r[4]*i+r[8]*s+r[12],o.y=r[1]*n+r[5]*i+r[9]*s+r[13],o.z=r[2]*n+r[6]*i+r[10]*s+r[14],o.w=r[3]*n+r[7]*i+r[11]*s+r[15]}function V(e,t,o,n){let i=!0,s=!1;return e.isLine?l(e,((e,n)=>{k(e,t,O),k(n,t,M);let a=r([O,M,z],o);2!==a&&(i=!1),0!==a&&(s=!0)})):c(e,((e,n,a)=>{k(e,t,O),k(n,t,M),k(a,t,z);let l=r([O,M,z],o);2!==l&&(i=!1),0!==l&&(s=!0)})),i?2:s?1:0}function R(e,t){this.camera=e,this.scene=t,this.startPoint=new u,this.endPoint=new u,this.result=[]}R.prototype.select=function(e,t,o){return this.startPoint=e||this.startPoint,this.endPoint=t||this.endPoint,this.result=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInRenderScene(m,o),this.result},R.prototype.updateFrustum=function(e,t){e=e||this.startPoint,t=t||this.endPoint,e.x===t.x&&(t.x+=Number.EPSILON),e.y===t.y&&(t.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),v.multiplyMatrices(this.camera.projectionMatrix,v.copy(this.camera.matrixWorld).invert());var o=Math.min(e.x,t.x),n=Math.max(e.y,t.y),i=Math.max(e.x,t.x),s=Math.min(e.y,t.y);g.set(o,n,-1),w.set(i,n,-1),b.set(i,s,-1),T.set(o,s,-1),C.set(o,n,1),A.set(i,n,1),B.set(i,s,1),E.set(o,s,1),y.min.x=o,y.min.y=s,y.min.z=-1,y.max.x=i,y.max.y=n,y.max.z=1,S.copy(v).invert(),g=a(g,S),w=a(w,S),b=a(b,S),T=a(T,S),C=a(C,S),A=a(A,S),B=a(B,S),E=a(E,S);var r=m.planes;r[0].setFromCoplanarPoints(g,C,A),r[1].setFromCoplanarPoints(w,A,B),r[2].setFromCoplanarPoints(B,E,T),r[3].setFromCoplanarPoints(E,C,g),r[4].setFromCoplanarPoints(w,b,T),r[5].setFromCoplanarPoints(B,A,C)},R.prototype.searchChildInRenderScene=function(e,t){let o=this.scene.getModels(),n={intersectsBox:function(t){return I(e,t)}};for(let i of o){let o=i.getFragmentList(),s=new Map;if(i.getIterator().intersectFrustum(n,((t,n)=>{let i;if(n?i=2:(o.getWorldBounds(t,f),i=I(e,f)),0===i)return;if(2!==i){o.getWorldMatrix(t,S),S.multiplyMatrices(v,S),i=V(o.getGeometry(t),S,y)}if(0===i)return;let r=o.getDbIds(t),a=s.get(r);(void 0===a||2===a&&2!==i)&&s.set(r,i)})),t){let e={model:i,ids:[]};s.forEach(((t,o)=>{2===t&&e.ids.push(o)})),this.result.push(e)}else this.result.push({model:i,ids:Array.from(s.keys())})}};class H{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.viewer=e,this.options=t,this.isDown=!1,this.element=document.createElement("div"),this.styleContains=this.options.styleContains||this.options.cssClassName||"box-selection-contains",this.styleIntersects=this.options.styleIntersects||this.options.cssClassName||"box-selection-intersects",this.element.classList.add(this.styleContains),this.element.style.pointerEvents="none",this.startPoint=new THREE.Vector2,this.endPoint=new THREE.Vector2,this.useGeometricIntersection=this.options.useGeometricIntersection,this.boxIntersection=new R(this.viewer.getCamera(),this.viewer.impl.modelQueue())}getName(){return"box-selection"}getNames(){return["box-selection"]}activate(){this.active=!0}deactivate(){this.onSelectOver(),this.active=!1}isActive(){return this.active}getCursor(){return"crosshair"}register(){}handleGesture(e){switch(e.type){case"dragstart":return this.handleButtonDown(e,0);case"dragmove":return this.handleMouseMove(e);case"dragend":return this.handleButtonUp(e,0)}return!1}handleButtonDown(e,t){return 0===t&&(this.viewer.impl.selector.clearSelection(),this.isDown=!0,this.onSelectStart(e),!0)}handleMouseMove(e){return!!this.isDown&&(this.onSelectMove(e),!0)}handleButtonUp(e,t){if(0!==t)return!1;this.isDown=!1,this.onSelectOver(e);const o=this.getSelection();return o.forEach((e=>{e.selectionType=this.options.selectionType})),this.viewer.impl.selector.setAggregateSelection(o),!0}getSelection(){const e=this.viewer.impl.getCanvasBoundingClientRect(),t=this.viewer.impl.clientToViewport(Math.min(this.startPoint.x,this.endPoint.x)-e.left,Math.max(this.startPoint.y,this.endPoint.y)-e.top),o=this.viewer.impl.clientToViewport(Math.max(this.startPoint.x,this.endPoint.x)-e.left,Math.min(this.startPoint.y,this.endPoint.y)-e.top);if(this.useGeometricIntersection)return this.boxIntersection.select(t,o,this.endPoint.x>this.startPoint.x);{const e=this.viewer.impl.hitBoxTestViewport(t,Math.abs(this.startPoint.x-this.endPoint.x)/this.viewer.impl.canvas.clientWidth,Math.abs(this.startPoint.y-this.endPoint.y)/this.viewer.impl.canvas.clientHeight),o=[],n={},i={};for(let t=0;t<e.length;t++){const o=e[t].model.id;i[o]||(i[o]=e[t].model),n[o]||(n[o]=[]),n[o].push(e[t].dbId)}for(let e in n)o.push({model:i[e],ids:n[e]});return o}}onSelectStart(e){this.viewer.canvas.parentElement.appendChild(this.element),this.element.style.left=e.clientX+"px",this.element.style.top=e.clientY+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=e.clientX,this.startPoint.y=e.clientY}onSelectMove(e){this.endPoint.x=e.clientX,this.endPoint.y=e.clientY;let t=Math.min(this.startPoint.x,this.endPoint.x),o=Math.max(this.startPoint.x,this.endPoint.x),n=Math.min(this.startPoint.y,this.endPoint.y),i=Math.max(this.startPoint.y,this.endPoint.y);this.element.style.left=t+"px",this.element.style.top=n+"px",this.element.style.width=o-t+"px",this.element.style.height=i-n+"px",this.useGeometricIntersection&&this.endPoint.x>=this.startPoint.x?this.element.classList.replace(this.styleIntersects,this.styleContains):this.element.classList.replace(this.styleContains,this.styleIntersects)}onSelectOver(){this.element.parentElement&&this.element.parentElement.removeChild(this.element)}}const L={en:JSON.parse('{"@@locale":"en","@@context":"BoxSelection Extension","Select":"Select"}'),"en-GB":JSON.parse('{"@@locale":"en","@@context":"BoxSelection Extension","Select":"Select"}'),cs:JSON.parse('{"@@locale":"cs","@@context":"Rozšíření BoxSelection","Select":"Vybrat"}'),de:JSON.parse('{"@@locale":"de","@@context":"Erweiterung BoxSelection","Select":"Auswählen"}'),es:JSON.parse('{"@@locale":"es","@@context":"BoxSelection Extension","Select":"Seleccionar"}'),fr:JSON.parse('{"@@locale":"fr","@@context":"Extension BoxSelection","Select":"Sélectionner"}'),"fr-CA":JSON.parse('{"@@locale":"fr-CA","@@context":"Extension BoxSelection","Select":"Sélectionner"}'),it:JSON.parse('{"@@locale":"it","@@context":"Estensione BoxSelection","Select":"Seleziona"}'),ja:JSON.parse('{"@@locale":"ja","@@context":"BoxSelection Extension","Select":"選択"}'),ko:JSON.parse('{"@@locale":"ko","@@context":"BoxSelection 확장","Select":"선택"}'),pl:JSON.parse('{"@@locale":"pl","@@context":"Rozszerzenie BoxSelection","Select":"Wybierz"}'),"pt-BR":JSON.parse('{"@@locale":"pt","@@context":"Extensão BoxSelection","Select":"Selecionar"}'),ru:JSON.parse('{"@@locale":"ru","@@context":"Расширение BoxSelection","Select":"Выбрать"}'),tr:JSON.parse('{"@@locale":"tr","@@context":"BoxSelection Uzantısı","Select":"Seç"}'),"zh-Hans":JSON.parse('{"@@locale":"zh-Hans","@@context":"BoxSelection 扩展","Select":"选择"}'),"zh-Hant":JSON.parse('{"@@locale":"zh-Hant","@@context":"BoxSelection 延伸","Select":"選取"}'),"zh-HK":JSON.parse('{"@@locale":"zh-hk","@@context":"BoxSelection 擴充程式","Select":"選取"}'),nl:JSON.parse('{"@@locale":"nl","@@context":"BoxSelection-extensie","Select":"Selecteren"}'),sv:JSON.parse('{"@@locale":"sv","@@context":"BoxSelection-tillägg","Select":"Välj"}'),da:JSON.parse('{"@@locale":"da","@@context":"BoxSelection-udvidelse","Select":"Vælg"}'),no:JSON.parse('{"@@locale":"no","@@context":"BoxSelection-utvidelse","Select":"Velg"}')};var J=o(93379),_=o.n(J),j=o(7795),U=o.n(j),G=o(90569),F=o.n(G),D=o(3565),W=o.n(D),K=o(19216),Z=o.n(K),q=o(44589),X=o.n(q),Y=o(13466),Q={};Q.styleTagTransform=X(),Q.setAttributes=W(),Q.insert=F().bind(null,"head"),Q.domAPI=U(),Q.insertStyleElement=Z();_()(Y.Z,Q);Y.Z&&Y.Z.locals&&Y.Z.locals;const $=Autodesk.Viewing,ee=$.UI.Button.State,te="box-selection",oe=te;class ne extends $.Extension{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.name=te,this._onToolChanged=this._onToolChanged.bind(this),this.options.selectionType=t.selectionType||(t.useGeometricIntersection?$.SelectionType.REGULAR:$.SelectionType.MIXED)}load(){return this.extendLocalization(L),this.boxSelectionTool=new H(this.viewer,this.options),this.viewer.toolController.registerTool(this.boxSelectionTool,((e,t)=>{this.setActive(e,t)})),this.registerHotkeys(),!0}unload(){if(this.viewer.getActiveNavigationTool()===oe&&this.viewer.setActiveNavigationTool(),this.boxSelectionToolButton){const e=this.viewer.getToolbar().getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);e&&(e.removeControl(this.boxSelectionToolButton.getId()),this.boxSelectionToolButton=null)}return this.viewer.toolController.deregisterTool(this.boxSelectionTool),this.viewer.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this._onToolChanged),this.viewer.getHotkeyManager().popHotkeys("Autodesk.BoxSelection"),!0}createToolbarButton(){const e=new Autodesk.Viewing.UI.Button("toolbar-box-selection");e.setIcon("adsk-icon-selection"),e.setToolTip("Select"),e.onClick=()=>{const t=e.getState();t===Autodesk.Viewing.UI.Button.State.INACTIVE?this.activate(te):t===Autodesk.Viewing.UI.Button.State.ACTIVE&&this.deactivate()},this.boxSelectionToolButton=e}addToolbarButton(e){var t,o;if(!this.boxSelectionToolButton)return;const n=null===(t=(o=this.viewer).getToolbar)||void 0===t?void 0:t.call(o),i=null==n?void 0:n.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);if(!i)return;const s=i.getControl(this.boxSelectionToolButton.getId());e&&!s?i.addControl(this.boxSelectionToolButton,{index:0}):!e&&s&&i.removeControl(this.boxSelectionToolButton)}onToolbarCreated(e){this.viewer.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this._onToolChanged),this.createToolbarButton(),this.addToolbarButton(!1)}registerHotkeys(){this.viewer.getHotkeyManager().pushHotkeys("Autodesk.BoxSelection",[{keycodes:[Autodesk.Viewing.KeyCode.CONTROL],onPress:()=>(this.boxSelectionTool.isActive()||(this.viewer.toolController.activateTool(this.boxSelectionTool.getName()),this.boxSelectionTool.__hotKey=!0),!0),onRelease:()=>(this.boxSelectionTool.__hotKey&&(this.viewer.toolController.deactivateTool(this.boxSelectionTool.getName()),this.boxSelectionTool.__hotKey=!1),!0)}])}activate(e){return e===te&&(this._updateActiveState(!0),this.viewer.setActiveNavigationTool(te)),!0}deactivate(){return this.viewer.setActiveNavigationTool(),this._updateActiveState(!1),!0}setSelectionType(e){this.options.selectionType=e||$.SelectionType.REGULAR}_updateActiveState(e){this.activeStatus=e,this.mode=e?te:""}_onToolChanged(e){if(e.toolName===oe&&this.boxSelectionToolButton){const t=e.active?ee.ACTIVE:ee.INACTIVE;this.boxSelectionToolButton.setState(t),this._updateActiveState(!t)}}}$.theExtensionManager.registerExtension("Autodesk.BoxSelection",ne)},13466:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});var n=o(87537),i=o.n(n),s=o(23645),r=o.n(s)()(i());r.push([e.id,".icon-box-selection{fill:none;stroke:currentColor;stroke-width:1;stroke-dasharray:4 2}.box-selection-contains{border:1px solid #808080;background-color:rgba(75,160,255,0.3);position:fixed}.box-selection-intersects{border:1px dotted #808080;background-color:rgba(75,255,160,0.3);position:fixed}\n","",{version:3,sources:["webpack://./extensions/BoxSelection/BoxSelection.css"],names:[],mappings:"AAAA,oBACE,SAAU,CACV,mBAAoB,CACpB,cAAe,CACf,oBAAqB,CACtB,wBAGC,wBAAyB,CACzB,qCAAyC,CACzC,cAAe,CAChB,0BAGC,yBAA0B,CAC1B,qCAAyC,CACzC,cAAe",sourcesContent:[".icon-box-selection {\n  fill: none;\n  stroke: currentColor;\n  stroke-width: 1;\n  stroke-dasharray: 4 2;\n}\n\n.box-selection-contains {\n  border: 1px solid #808080;\n  background-color: rgba(75, 160, 255, 0.3);\n  position: fixed;\n}\n\n.box-selection-intersects {\n  border: 1px dotted #808080;\n  background-color: rgba(75, 255, 160, 0.3);\n  position: fixed;\n}"],sourceRoot:""}]);const a=r},23645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o="",n=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),n&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),n&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o})).join("")},t.i=function(e,o,n,i,s){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(n)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(r[l]=!0)}for(var c=0;c<e.length;c++){var h=[].concat(e[c]);n&&r[h[0]]||(void 0!==s&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=s),o&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=o):h[2]=o),i&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=i):h[4]="".concat(i)),t.push(h))}},t}},87537:e=>{"use strict";e.exports=function(e){var t=e[1],o=e[3];if(!o)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),s="/*# ".concat(i," */"),r=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[t].concat(r).concat([s]).join("\n")}return[t].join("\n")}},93379:e=>{"use strict";var t=[];function o(e){for(var o=-1,n=0;n<t.length;n++)if(t[n].identifier===e){o=n;break}return o}function n(e,n){for(var s={},r=[],a=0;a<e.length;a++){var l=e[a],c=n.base?l[0]+n.base:l[0],h=s[c]||0,u="".concat(c," ").concat(h);s[c]=h+1;var d=o(u),x={css:l[1],media:l[2],sourceMap:l[3]};-1!==d?(t[d].references++,t[d].updater(x)):t.push({identifier:u,updater:i(x,n),references:1}),r.push(u)}return r}function i(e,t){var o=t.domAPI(t);return o.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o.update(e=t)}else o.remove()}}e.exports=function(e,i){var s=n(e=e||[],i=i||{});return function(e){e=e||[];for(var r=0;r<s.length;r++){var a=o(s[r]);t[a].references--}for(var l=n(e,i),c=0;c<s.length;c++){var h=o(s[c]);0===t[h].references&&(t[h].updater(),t.splice(h,1))}s=l}}},90569:e=>{"use strict";var t={};e.exports=function(e,o){var n=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(o)}},19216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t),t}},3565:(e,t,o)=>{"use strict";e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var n=o.css,i=o.media,s=o.sourceMap;i?e.setAttribute("media",i):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(n,e)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},44589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={id:n,exports:{}};return e[n](s,s.exports,o),s.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n=o(54707);Autodesk.Extensions.BoxSelection=n})();
//# sourceMappingURL=BoxSelection.min.js.map